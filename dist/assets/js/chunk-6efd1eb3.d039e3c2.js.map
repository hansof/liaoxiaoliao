{"version":3,"sources":["webpack:///./src/assets/img/remove.png","webpack:///./src/views/submitTs.vue?017e","webpack:///./src/views/submitTs.vue?96b7","webpack:///src/views/submitTs.vue","webpack:///./src/views/submitTs.vue?1bb6","webpack:///./src/views/submitTs.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","ref","attrs","on","numcont","_s","numberCont","images","length","_l","item","index","key","refInFor","$event","removearr","checkImg","sl1","sl2","sl3","upload","_e","submiData","staticRenderFns","name","data","userInfo","$util","parse","getCookie","isupload","files","methods","img","src","link","onload","width","height","e","path","style","udimg","unfile","console","log","blackTs","formDataRequest","paramJson","res","errorCode","reader","readAsDataURL","file","image","Image","result","canvas","document","querySelector","context","getContext","drawImage","target","value","component"],"mappings":"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","file":"assets/js/chunk-6efd1eb3.d039e3c2.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAATlBMVEUAAAD////u7u7t7e3s7Ozs7Ozs7Oz////u7u7s7Ozs7Ozt7e3t7e3////u7u7t7e3q6uri4uKkpKSZmZm7u7u5ubnr6+ulpaXs7Ozt7e16jyp0AAAAGnRSTlMAAjyMv9nzCHbp/1PiAYWo///////////yizFKcz0AAAC/SURBVHgBhZMFmoUwDAZTb3/c4f4X3UWa76EdnKk3IUZIpY21Risp6IrzAUzw7myzHCfy7EcWJW6UBdsKD1TRl3ikPPrFC1v/Ln/T+Tp+j1c8keD51g12mjrOX5Bk23Y9VvqujV6Sirrpum4AMPw/YzuKNCL96sfV9jjQZMCsZtraiBiyOPmThT3pca07jWBmMl+1DemvvjWpr5EvJL/mLXlRz6vGi0r+fc19akMT4ZAIpkQoJgI5kQaJJEqk4B+yTyB2AS1p6wAAAABJRU5ErkJggg==\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./submitTs.vue?vue&type=style&index=0&id=39f33e77&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./submitTs.vue?vue&type=style&index=0&id=39f33e77&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"submitTs\"},[_c('div',{staticClass:\"typeText\"},[_vm._v(\"投诉描述（必填）\")]),_c('textarea',{ref:\"content\",staticClass:\"contentText\",attrs:{\"name\":\"\",\"placeholder\":\"请输入投诉详情\",\"maxlength\":\"200\",\"id\":\"content\",\"cols\":\"30\",\"rows\":\"10\"},on:{\"input\":_vm.numcont}}),_c('div',{staticClass:\"numberCont\"},[_vm._v(_vm._s(_vm.numberCont)+\"/200\")]),_c('div',{staticClass:\"clear\"}),_c('div',{staticClass:\"typeText\"},[_vm._v(\"\\n    证据截图（选填）\\n    \"),_c('span',[_vm._v(_vm._s(_vm.images.length)+\"/4\")])]),_c('canvas',{attrs:{\"id\":\"myCanvas\"}}),_c('ul',{staticClass:\"imgCont\"},[_vm._l((_vm.images),function(item,index){return [_c('li',{key:'img'+index},[_c('img',{ref:\"dataremove\",refInFor:true,staticClass:\"removeimg\",attrs:{\"src\":require(\"../assets/img/remove.png\"),\"data-remove\":index,\"alt\":\"\"},on:{\"click\":function($event){return _vm.removearr(index)}}}),_c('div',{staticClass:\"overflowbigimg\"},[_c('img',{staticClass:\"bigimg\",attrs:{\"src\":'data:image/jpeg;base64,'+item,\"preview\":\"1\",\"alt\":\"\"},on:{\"load\":function($event){return _vm.checkImg('data:image/jpeg;base64,'+item,$event)}}})])])]}),(_vm.isupload)?_c('li',[_c('div',{staticClass:\"shizi_div\"},[_c('input',{staticClass:\"uploadBtn\",attrs:{\"type\":\"file\",\"accept\":\"image/*\",\"name\":\"imageFile\"},on:{\"focus\":function($event){_vm.sl1=_vm.sl2=_vm.sl3=false},\"change\":function($event){return _vm.upload()}}})])]):_vm._e(),_c('div',{staticClass:\"clear\"})],2),_c('div',{staticClass:\"typeText\"},[_vm._v(\"联系方式（选填）\")]),_c('input',{ref:\"myPhone\",staticClass:\"myPhone\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入手机号或者微信号，方便及时联系到您\",\"maxlength\":\"20\"}}),_c('div',{staticClass:\"clear\"}),_c('a',{staticClass:\"submitBtn\",attrs:{\"href\":\"javascript:;\"},on:{\"click\":_vm.submiData}},[_vm._v(\"提交\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"submitTs\">\n    <div class=\"typeText\">投诉描述（必填）</div>\n    <textarea name placeholder=\"请输入投诉详情\" class=\"contentText\" @input=\"numcont\" maxlength=\"200\" id=\"content\" ref=\"content\" cols=\"30\" rows=\"10\"></textarea>\n    <div class=\"numberCont\" >{{numberCont}}/200</div>\n    <div class=\"clear\"></div>\n    <div class=\"typeText\">\n      证据截图（选填）\n      <span>{{images.length}}/4</span>\n    </div>\n    <canvas id=\"myCanvas\"></canvas>\n    <ul class=\"imgCont\">\n      <template v-for=\"(item , index) in images\">\n        <li :key=\"'img'+index\">\n          <img\n            src=\"../assets/img/remove.png\"\n            :data-remove=\"index\"\n            @click=\"removearr(index)\"\n            ref=\"dataremove\"\n            class=\"removeimg\"\n            alt\n          />\n          <div class=\"overflowbigimg\">\n            <img\n              :src=\"'data:image/jpeg;base64,'+item\"\n              class=\"bigimg\"\n              @load=\"checkImg('data:image/jpeg;base64,'+item,$event)\"\n              preview=\"1\"\n              alt\n            />\n          </div>\n        </li>\n      </template>\n      <li v-if=\"isupload\">\n        <div class=\"shizi_div\">\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            name=\"imageFile\"\n            class=\"uploadBtn\"\n            @focus=\"sl1=sl2=sl3=false\"\n            @change=\"upload()\"\n          />\n        </div>\n      </li>\n      <div class=\"clear\"></div>\n    </ul>\n    <div class=\"typeText\">联系方式（选填）</div>\n    <input type=\"text\" placeholder=\"请输入手机号或者微信号，方便及时联系到您\"  maxlength=\"20\"  ref=\"myPhone\" class=\"myPhone\" />\n    <div class=\"clear\"></div>\n    <a href=\"javascript:;\" class=\"submitBtn\" @click=\"submiData\">提交</a>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"submitTs\",\n  data() {\n    return {\n      userInfo: this.$util.parse(this.$util.getCookie(\"userInfo\")),\n      images: [],\n      isupload: true,\n      numberCont:0,\n      files:[]\n    };\n  },\n  methods: {\n    checkImg(link, e) {\n      let that = this;\n      let img = new Image();\n      let fontSize = Number(\n        document.documentElement.style.fontSize.replace(\"px\", \"\")\n      );\n      img.src = link;\n      img.onload = function() {\n        if (img.width >= img.height) {\n          e.path[0].style.height = \"100%\";\n          e.path[0].style.width = \"auto\";\n        } else {\n          e.path[0].style.height = \"auto\";\n          e.path[0].style.width = \"100%\";\n        }\n      };\n      return;\n    },\n    /**\n     * 删除图片\n     */\n    removearr(n) {\n      let udimg = this.images\n        .slice(0, n)\n        .concat(this.images.slice(n + 1, this.images.length));\n      this.images = udimg;\n      let unfile= this.files.slice(0, n).concat(this.files.slice(n + 1, this.files.length));\n      this.files = unfile;\n      if (this.images.length < 4) {\n        this.isupload = true;\n      }\n    },\n    submiData() {\n      console.log(1);\n      if(this.$refs.content.value.length < 5 || this.$refs.content.value.length>200 ){\n        this.$util.blackTs('投诉详情须大于5，小于200字');\n        return\n      }\n      let paramJson = {\n        path: \"api-server/form/resource/feedback/submit\",\n          data: {\n            userNo: this.userInfo.wxUser.userNo,\n            content:this.$refs.content.value,\n            category: this.$route.query.typeId,\n            images:this.files.length && this.files,\n            relation: this.$refs.myPhone.value,\n            contentId:this.$route.query.orderId\n          }\n        };\n      this.formDataRequest(paramJson, res => {\n         console.log(2);\n        if (res.data.errorCode == \"0000\") {\n          this.$router.replace({path:\"/success\",query:{orderId:this.$route.query.orderId}});\n        }\n      });\n\n     \n    },\n    //图片压缩上传\n    upload() {\n      this.sl1 = false;\n      this.sl3 = false;\n      this.sl2 = false;\n      let file = document.querySelector(\"input[type=file]\").files[0]; // 获取选择的文件，这里是图片类型\n      let reader = new FileReader();\n      reader.readAsDataURL(file); //读取文件并将文件以URL的形式保存在resulr属性中 base64格式\n      reader.onload = e => {\n        // 文件读取完成时触发\n        let result = e.target.result; // base64格式图片地址\n        var image = new Image();\n        image.src = result; // 设置image的地址为base64的地址\n        image.onload = () => {\n          var canvas = document.querySelector(\"#myCanvas\");\n          var context = canvas.getContext(\"2d\");\n          canvas.width = image.width; // 设置canvas的画布宽度为图片宽度\n          canvas.height = image.height;\n          context.drawImage(image, 0, 0, image.width, image.height); // 在canvas上绘制图片\n          let dataUrl = canvas.toDataURL(\"image/jpeg\", 0.1); // 0.70为压缩比，可根据需要设置，设置过小会影响图片质量\n\n          // dataUrl 为压缩后的图片资源，可将其上传到服务器\n          this.images.push(dataUrl.split(\",\")[1]);\n          this.files.push(document.querySelector(\"input[type=file]\").files[0]);\n          //this.images.push(this.convertBase64UrlToBlob(dataUrl))\n          //console.log(this.convertBase64UrlToBlob(dataUrl));\n          //this.bs.push(this.convertBase64UrlToBlob(dataUrl));\n          //this.blobToDataURL(this.bs[0])\n          if (this.images.length >= 4) {\n            this.isupload = false;\n          }\n          this.$previewRefresh(); //upload后, 刷新preview插件\n        };\n      };\n    },\n    numcont(e){\n      this.numberCont=e.target.value.length;\n      if(e.target.value.length > 200){\n        e.target.value=e.target.value.substr(0,200);\n      }\n\n    }\n  }\n};\n</script>\n\n<style scoped>\n#myCanvas {\n  display: none;\n}\ninput {\n  -webkit-appearance: none;\n}\ninput::-webkit-input-placeholder,\ntextarea::-webkit-input-placeholder {\n  color: #bebebe;\n}\n.typeText {\n  height: 0.76rem;\n  font-size: 0.26rem;\n  color: #888888;\n  text-indent: 0.24rem;\n  line-height: 1rem;\n  width: 100%;\n  overflow: hidden;\n}\n.contentText {\n  width: 100%;\n  float: left;\n  height: 1.5rem;\n  border: none;\n  font-size: 0.28rem;\n  color: #333333;\n  padding: 0.25rem 0.24rem;\n  line-height: 0.35rem;\n}\n.numberCont {\n  font-size: 0.26rem;\n  padding: 0 0.2rem;\n  background: #fff;\n  color: #bebebe;\n  float: left;\n  width: 100%;\n  text-align: right;\n  line-height: 0.8rem;\n  height: 0.8rem;\n}\n.imgCont {\n  background: #fff;\n  width: 100%;\n  padding: 0.3rem 0;\n  /* padding-left: 0.24rem; */\n\n}\n.imgCont li {\n  width: 1.42rem;\n  height: 1.42rem;\n  float: left;\n  position: relative;\n  margin: 0 .225rem;\n  border-radius: 0.06rem;\n}\n.imgCont li img.removeimg {\n  position: absolute;\n  right: -0.1rem;\n  top: -0.1rem;\n  width: 0.3rem;\n  height: 0.3rem;\n  z-index: 111;\n}\n.shizi_div {\n  height: 1.42rem;\n  width: 1.42rem;\n  background: url(../assets/img/shizi.png) no-repeat center center;\n  background-color: #f4f4f4;\n  background-size: 0.6rem 0.6rem;\n  border-radius: 0.06rem;\n}\n.uploadBtn {\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  float: left;\n}\n.myPhone {\n  width: 100%;\n  font-size: 0.28rem;\n  text-indent: 0.24rem;\n  height: 0.9rem;\n  color: #333333;\n  float: left;\n}\n.submitBtn {\n  width: 80%;\n  height: 0.94rem;\n  display: block;\n  font-size: 0.36rem;\n  color: #fff;\n  text-align: center;\n  background: #1aad19;\n  line-height: 0.94rem;\n  border-radius: 0.1rem;\n  margin: 0.6rem auto;\n}\n.typeText span {\n  float: right;\n  height: auto;\n  margin-right: 0.24rem;\n  color: #bebebe;\n}\n.imgCont li .overflowbigimg {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 0.06rem;\n  overflow: hidden;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./submitTs.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./submitTs.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./submitTs.vue?vue&type=template&id=39f33e77&scoped=true&\"\nimport script from \"./submitTs.vue?vue&type=script&lang=js&\"\nexport * from \"./submitTs.vue?vue&type=script&lang=js&\"\nimport style0 from \"./submitTs.vue?vue&type=style&index=0&id=39f33e77&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"39f33e77\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}